<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Login - Mi Empresa</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div class="login-container">
        <div class="login-card">
            <h2>Iniciar Sesión</h2>
            <input type="text" id="usuario" placeholder="Usuario">
            <input type="password" id="password" placeholder="Contraseña">
            <button class="hero-button" onclick="validar()">Entrar</button>
            <p id="mensaje" style="color: red; font-size: 14px; margin-top: 10px;"></p>
        </div>
    </div>

    <script>
    // La palabra "async" es necesaria para esperar la respuesta del servidor
    async function validar() {
        const user = document.getElementById('usuario').value;
        const pass = document.getElementById('password').value;
        const mensaje = document.getElementById('mensaje');

        // Limpiamos mensajes anteriores
        mensaje.innerText = "Consultando al servidor...";
        mensaje.style.color = "blue";

        try {
            // 1. Enviamos los datos a tu servidor local (puerto 3000)
            const respuesta = await fetch('http://localhost:3000/login', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ usuario: user, password: pass })
            });

            // 2. Esperamos a ver qué dice el servidor (convertimos a JSON)
            const datos = await respuesta.json();

            // 3. Verificamos la respuesta
            if (datos.exito === true) {
                // ¡Login correcto!
                mensaje.innerText = "¡Bienvenido! Redirigiendo...";
                mensaje.style.color = "green";
                
                // Esperamos 1 segundo para que se vea el mensaje y entramos
                setTimeout(() => {
                  
                    window.location.href = 'inicio.html';
                }, 1000);
            } else {
                // Login fallido
                mensaje.innerText = "Usuario o contraseña incorrectos.";
                mensaje.style.color = "red";
            }

        } catch (error) {
            console.error("Error:", error);
            mensaje.innerText = "Error: No puedo conectar con el servidor.";
            mensaje.style.color = "red";
        }
    }
</script>

</body>
</html>